{% extends "base_fd4.html" %}
{% block pagetitle %}Mozilla Reps - People{% endblock %}

{% block content %}
<main role="main" class="people-main">

  <!-- Map -->
  <div class="row">
    <div class="large-12 columns">
      <div id="map" class="map300">
      </div>
    </div>
  </div>

  <!-- Search box -->
  <div class="row">
    <div class="large-12 columns" id="search">
      <form id="searchform" role="search" aria-controls="profiles_gridview">
        <span class="pictogram-search">
          <div id="search-ready-icon" class="hidden pict-icon large search"></div>
          <div id="search-loading-icon"></div>
        </span>
        <input type="text" placeholder="Loading&hellip;" id="searchfield" disabled="disabled">
      </form>
      <ul class="button-group search-controls" aria-controls="profiles_gridview">
        <li role="button" id="adv-search-icon" title="Advanced Options" class="pictogram-button" tabindex="0">
          <div class="pict-icon large tools"></div>
        </li>
        <li role="button" id="gridviewbutton" title="Grid View" class="pictogram-button" tabindex="0">
          <div class="pict-icon large grid"></div>
        </li>
        <li role="button" id="listviewbutton" title="List View" class="pictogram-button" tabindex="0">
          <div class="pict-icon large list"></div>
        </li>
      </ul>
    </div>
  </div>

  <!-- Advanced search box -->
  <div class="row hidden" id="adv-search">
    <div class="large-12 columns">
      <form class="row">
        <div class="large-3 columns">
          <select id="adv-search-group">
            <option value="">All Groups</option>
            <option value="rep">Rep</option>
            <option value="mentor">Mentor</option>
            <option value="council">Council</option>
          </select>
        </div>
        <div class="large-3 columns">
          <select id="adv-search-country">
            <option value="">All Countries</option>
            {% for country in countries %}
              <option value="{{ country|lower }}">{{ country }}</option>
            {% endfor %}
          </select>
        </div>
        <div class="large-3 columns">
          <select id="adv-search-area">
            <option value="">All Areas</option>
            {% for area in areas %}
              <option value="{{ area|lower }}">{{ area }}</option>
            {% endfor %}
          </select>
        </div>
        <div class="large-3 columns align-center">
          {% if user.is_authenticated() %}
            <button id="csv-export-button"
                    class="small white button nice radius">CSV Export</button>
          {% endif %}
        </div>
      </form>
    </div>
  </div>

  <!-- People are here -->
  <div class="row hidden" id="profiles_noresults">
    <div class="large-12 columns profiles-no-results">
      Sorry, no Reps found.
    </div>
  </div>

  <div class="row" id="profiles_gridview" role="region">
    <div class="large-12 columns">
      <ul class="large-block-grid-3 small-block-grid-1" id="grid-search-list"></ul>
    </div>
  </div>

  <div id="profiles_listview">
    <div class="row show-for-small mobile-list-warning">
      Please switch to grid view.
    </div>
    <div class="row hide-for-small">
      <div class="large-12 columns">
        <table id="list-people-view">
          <thead>
            <tr>
              <th>Full Name</th>
              <th>Name in local language</th>
              <th>Username</th>
              <th>City</th>
              <th>Region</th>
              <th>Country</th>
            </tr>
          </thead>
          <tbody id="table-search-list">
          </tbody>
        </table>
      </div>
    </div>
  </div>

  <!-- Loader animation -->
  <div class="row" id="profiles-loading-wrapper">
    <div class="large-12 columns">
      <div id="profiles-loading"></div>
    </div>
  </div>

  {% if user.is_authenticated() %}
    <div id="profiles-reps-number" class="row">
      <div id="profiles-number-of-reps" class="large-12 columns reps-number">
      </div>
    </div>
  {% endif %}

  {% for rep in reps %}
    <div class="profile-pointer-item"
         data-lat="{{ rep.userprofile.lat }}"
         data-lon="{{ rep.userprofile.lon }}"
         data-fullname="{{ rep.get_full_name() }}">
    </div>
  {% endfor %}

</main>

<script id="gridItem-tmpl" type="text/x-jquery-tmpl">
  <li class="profiles-li-item"
      data-lon="${ profile.lon }" data-lat="${ profile.lat }"
      data-fullname="${ fullname }">
    <a class="panel grid-profile" href="${ profile.profile_url }">
      <div class="row">
        <div class="large-3 small-3 columns grid-profile-image">
          <img src="${ profile.avatar_url }"
               class="profiles-people-avatar"
               alt="${ fullname } avatar">
        </div>
        <div class="large-9 small-9 columns grid-profile-text">
          <h6>${ first_name }<br>${ last_name }</h6>
          ${ profile.city }, ${ profile.country }
        </div>
      </div>
    </a>
  </li>
</script>

<script id="listItem-tmpl" type="text/x-jquery-tmpl">
  <tr>
    <td>
      <a href="${ profile.profile_url }">
        ${ fullname }
      </a>
    </td>
    <td>
      ${ profile.local_name }
    </td>
    <td>
      ${ profile.display_name }
    </td>
    <td>
      <a href="{{ url('profiles_list_profiles') }}search/${ profile.city }">
        ${ profile.city }
      </a>
    </td>
    <td>
      <a href="{{ url('profiles_list_profiles') }}search/${ profile.region }">
        ${ profile.region }
      </a>
    </td>
    <td>
      <a href="{{ url('profiles_list_profiles') }}country/${ profile.country }">
        ${ profile.country }
      </a>
    </td>
  </tr>
</script>
{% endblock %}

{% block bottomextra %}
{{ css('leaflet') }}
<!--[if lte IE 8]>
    <link rel="stylesheet" href="{{ MEDIA_URL }}/leaflet/leaflet.ie.css" />
<![endif]-->
{{ js('leaflet') }}
{{ js('profiles_people') }}
{% endblock %}
